<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="å‡è®¾è¦ç”¨JavaScriptå®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é€’å½’å®ç°:
function factorial(n) { if(n === 1) { return 1 } return n * factorial(n-1) } console.log(factorial(4)) // 24 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç”±äºæœ€åä¸€æ­¥è¿”å›äº†ä¸€ä¸ªè¡¨è¾¾å¼(n * factorial(n-1))ï¼Œæ‰€ä»¥ä¼šä¿ç•™nè¿™ä¸ªå˜é‡å’Œå‡½æ•°factorial(n-1)çš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ï¼Œä»è€Œå½¢æˆä¸€å±‚å±‚çš„è°ƒç”¨å¸§ã€‚
é€’å½’ååˆ†æ¶ˆè€—å†…å­˜ï¼Œå› ä¸ºè¦åŒæ—¶ä¿å­˜éå¸¸å¤šä¸ªè°ƒç”¨è®°å½•ï¼Œå®¹æ˜“å‡ºç°&amp;quot;æ ˆæº¢å‡º&amp;quot;é”™è¯¯(Stack Overflow)
å°¾è°ƒç”¨ å°¾è°ƒç”¨æ˜¯æŒ‡çš„ä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€ä¸ªåŠ¨ä½œæ˜¯è¿”å›å¦ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨
function foo(n) { return meh(n) } // å¹¶ä¸ä¸€å®šè¦åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ // ä»¥ä¸‹meh å’Œnco å‡½æ•°å‡å±äºå°¾è°ƒç”¨ function foo(n) { if(n&amp;gt;0) { return meh(n) } return nco(n) } ä¸å±äºå°¾è°ƒç”¨çš„æƒ…å†µ
// å‡½æ•°è°ƒç”¨åè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰ä¸€æ · function foo(n) { let tmp = meh(n) return tmp } // å‡½æ•°è°ƒç”¨åè¿˜æœ‰ç›¸åŠ æ“ä½œ function foo(n) { return meh(n) + 1 } // æ²¡æœ‰è¿”å›å‡½æ•°è°ƒç”¨ function foo(n) { meh(n) } å°¾è°ƒç”¨ä¼˜åŒ–  ã€€å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨è®°å½•&amp;quot;ï¼Œåˆç§°&amp;quot;è°ƒç”¨å¸§&amp;quot; (call frame)ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨æ ˆ&amp;quot; (call stack)ã€‚"><title>ES6ä¸­çš„å°¾é€’å½’</title><link rel=canonical href=https://chaosalphard.github.io/p/es6%E4%B8%AD%E7%9A%84%E5%B0%BE%E9%80%92%E5%BD%92/><link rel=stylesheet href=/scss/style.min.css><meta property="og:title" content="ES6ä¸­çš„å°¾é€’å½’"><meta property="og:description" content="å‡è®¾è¦ç”¨JavaScriptå®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é€’å½’å®ç°:
function factorial(n) { if(n === 1) { return 1 } return n * factorial(n-1) } console.log(factorial(4)) // 24 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç”±äºæœ€åä¸€æ­¥è¿”å›äº†ä¸€ä¸ªè¡¨è¾¾å¼(n * factorial(n-1))ï¼Œæ‰€ä»¥ä¼šä¿ç•™nè¿™ä¸ªå˜é‡å’Œå‡½æ•°factorial(n-1)çš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ï¼Œä»è€Œå½¢æˆä¸€å±‚å±‚çš„è°ƒç”¨å¸§ã€‚
é€’å½’ååˆ†æ¶ˆè€—å†…å­˜ï¼Œå› ä¸ºè¦åŒæ—¶ä¿å­˜éå¸¸å¤šä¸ªè°ƒç”¨è®°å½•ï¼Œå®¹æ˜“å‡ºç°&amp;quot;æ ˆæº¢å‡º&amp;quot;é”™è¯¯(Stack Overflow)
å°¾è°ƒç”¨ å°¾è°ƒç”¨æ˜¯æŒ‡çš„ä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€ä¸ªåŠ¨ä½œæ˜¯è¿”å›å¦ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨
function foo(n) { return meh(n) } // å¹¶ä¸ä¸€å®šè¦åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ // ä»¥ä¸‹meh å’Œnco å‡½æ•°å‡å±äºå°¾è°ƒç”¨ function foo(n) { if(n&amp;gt;0) { return meh(n) } return nco(n) } ä¸å±äºå°¾è°ƒç”¨çš„æƒ…å†µ
// å‡½æ•°è°ƒç”¨åè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰ä¸€æ · function foo(n) { let tmp = meh(n) return tmp } // å‡½æ•°è°ƒç”¨åè¿˜æœ‰ç›¸åŠ æ“ä½œ function foo(n) { return meh(n) + 1 } // æ²¡æœ‰è¿”å›å‡½æ•°è°ƒç”¨ function foo(n) { meh(n) } å°¾è°ƒç”¨ä¼˜åŒ–  ã€€å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨è®°å½•&amp;quot;ï¼Œåˆç§°&amp;quot;è°ƒç”¨å¸§&amp;quot; (call frame)ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨æ ˆ&amp;quot; (call stack)ã€‚"><meta property="og:url" content="https://chaosalphard.github.io/p/es6%E4%B8%AD%E7%9A%84%E5%B0%BE%E9%80%92%E5%BD%92/"><meta property="og:site_name" content="Ilirus"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:tag" content="JavaScript"><meta property="article:published_time" content="2019-06-01T15:29:46+00:00"><meta property="article:modified_time" content="2019-06-01T15:29:46+00:00"><meta name=twitter:title content="ES6ä¸­çš„å°¾é€’å½’"><meta name=twitter:description content="å‡è®¾è¦ç”¨JavaScriptå®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é€’å½’å®ç°:
function factorial(n) { if(n === 1) { return 1 } return n * factorial(n-1) } console.log(factorial(4)) // 24 åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç”±äºæœ€åä¸€æ­¥è¿”å›äº†ä¸€ä¸ªè¡¨è¾¾å¼(n * factorial(n-1))ï¼Œæ‰€ä»¥ä¼šä¿ç•™nè¿™ä¸ªå˜é‡å’Œå‡½æ•°factorial(n-1)çš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ï¼Œä»è€Œå½¢æˆä¸€å±‚å±‚çš„è°ƒç”¨å¸§ã€‚
é€’å½’ååˆ†æ¶ˆè€—å†…å­˜ï¼Œå› ä¸ºè¦åŒæ—¶ä¿å­˜éå¸¸å¤šä¸ªè°ƒç”¨è®°å½•ï¼Œå®¹æ˜“å‡ºç°&amp;quot;æ ˆæº¢å‡º&amp;quot;é”™è¯¯(Stack Overflow)
å°¾è°ƒç”¨ å°¾è°ƒç”¨æ˜¯æŒ‡çš„ä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€ä¸ªåŠ¨ä½œæ˜¯è¿”å›å¦ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨
function foo(n) { return meh(n) } // å¹¶ä¸ä¸€å®šè¦åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯ // ä»¥ä¸‹meh å’Œnco å‡½æ•°å‡å±äºå°¾è°ƒç”¨ function foo(n) { if(n&amp;gt;0) { return meh(n) } return nco(n) } ä¸å±äºå°¾è°ƒç”¨çš„æƒ…å†µ
// å‡½æ•°è°ƒç”¨åè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰ä¸€æ · function foo(n) { let tmp = meh(n) return tmp } // å‡½æ•°è°ƒç”¨åè¿˜æœ‰ç›¸åŠ æ“ä½œ function foo(n) { return meh(n) + 1 } // æ²¡æœ‰è¿”å›å‡½æ•°è°ƒç”¨ function foo(n) { meh(n) } å°¾è°ƒç”¨ä¼˜åŒ–  ã€€å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨è®°å½•&amp;quot;ï¼Œåˆç§°&amp;quot;è°ƒç”¨å¸§&amp;quot; (call frame)ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ª&amp;quot;è°ƒç”¨æ ˆ&amp;quot; (call stack)ã€‚"></head><body class=article-page><script>(function(){const a='StackColorScheme';localStorage.getItem(a)||localStorage.setItem(a,"auto")})()</script><script>(function(){const b='StackColorScheme',a=localStorage.getItem(b),c=window.matchMedia('(prefers-color-scheme: dark)').matches===!0;a=='dark'||a==='auto'&&c?document.documentElement.dataset.scheme='dark':document.documentElement.dataset.scheme='light'})()</script><div class="container main-container flex
on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=åˆ‡æ¢èœå•>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header class=site-info><figure class=site-avatar><img src=/img/avatar_hu3efe4cd0dfb29873d1b0d65561d00585_584028_300x0_resize_box_2.png width=300 height=300 class=site-logo loading=lazy alt=Avatar>
<span class=emoji>ğŸŒŒ</span></figure><h1 class=site-name><a href=https://chaosalphard.github.io>Ilirus</a></h1><h2 class=site-description>Lorem ipsum dolor sit amet, consectetur adipiscing elit.</h2></header><ol class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><path d="M9 21v-6a2 2 0 012-2h2a2 2 0 012 2v6"/></svg><span>Home</span></a></li><li><a href=/about/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="7" r="4"/><path d="M6 21v-2a4 4 0 014-4h4a4 4 0 014 4v2"/></svg><span>About</span></a></li><li><a href=/archives/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><rect x="3" y="4" width="18" height="4" rx="2"/><path d="M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8"/><line x1="10" y1="12" x2="14" y2="12"/></svg><span>Archives</span></a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg><span>Search</span></a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>æš—è‰²æ¨¡å¼</span></li></ol></aside><main class="main full-width"><article class=main-article><header class=article-header><div class=article-details><header class=article-category><a href=/categories/%E7%BC%96%E7%A8%8B/>ç¼–ç¨‹</a>
<a href=/categories/%E5%89%8D%E7%AB%AF/>å‰ç«¯</a></header><h2 class=article-title><a href=/p/es6%E4%B8%AD%E7%9A%84%E5%B0%BE%E9%80%92%E5%BD%92/>ES6ä¸­çš„å°¾é€’å½’</a></h2><footer class=article-time><div><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><path d="M11.795 21H5a2 2 0 01-2-2V7a2 2 0 012-2h12a2 2 0 012 2v4"/><circle cx="18" cy="18" r="4"/><path d="M15 3v4"/><path d="M7 3v4"/><path d="M3 11h16"/><path d="M18 16.496V18l1 1"/></svg><time class=article-time--published>Jun 01, 2019</time></div></footer></div></header><section class=article-content><p>å‡è®¾è¦ç”¨<code>JavaScript</code>å®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œå¾ˆå®¹æ˜“æƒ³åˆ°ç”¨é€’å½’å®ç°:</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>factorial</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>if</span><span class=p>(</span><span class=nx>n</span> <span class=o>===</span> <span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=mi>1</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=nx>n</span> <span class=o>*</span> <span class=nx>factorial</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span>
<span class=p>}</span>

<span class=nx>console</span><span class=p>.</span><span class=nx>log</span><span class=p>(</span><span class=nx>factorial</span><span class=p>(</span><span class=mi>4</span><span class=p>))</span>   <span class=c1>// 24
</span></code></pre></div><p>åœ¨ä¸Šè¿°ä»£ç ä¸­ï¼Œç”±äºæœ€åä¸€æ­¥è¿”å›äº†ä¸€ä¸ªè¡¨è¾¾å¼(<code>n * factorial(n-1)</code>)ï¼Œæ‰€ä»¥ä¼šä¿ç•™<code>n</code>è¿™ä¸ªå˜é‡å’Œå‡½æ•°<code>factorial(n-1)</code>çš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ï¼Œä»è€Œå½¢æˆä¸€å±‚å±‚çš„è°ƒç”¨å¸§ã€‚</p><p>é€’å½’ååˆ†æ¶ˆè€—å†…å­˜ï¼Œå› ä¸ºè¦åŒæ—¶ä¿å­˜éå¸¸å¤šä¸ªè°ƒç”¨è®°å½•ï¼Œå®¹æ˜“å‡ºç°"æ ˆæº¢å‡º"é”™è¯¯<code>(Stack Overflow)</code></p><h1 id=å°¾è°ƒç”¨>å°¾è°ƒç”¨</h1><p>å°¾è°ƒç”¨æ˜¯æŒ‡çš„ä¸€ä¸ªå‡½æ•°çš„æœ€åä¸€ä¸ªåŠ¨ä½œæ˜¯è¿”å›å¦ä¸€ä¸ªå‡½æ•°çš„è°ƒç”¨</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>foo</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nx>meh</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=p>}</span>

<span class=c1>// å¹¶ä¸ä¸€å®šè¦åœ¨å‡½æ•°å°¾éƒ¨ï¼Œåªè¦æ˜¯æœ€åä¸€æ­¥æ“ä½œå³å¯
</span><span class=c1>// ä»¥ä¸‹meh å’Œnco å‡½æ•°å‡å±äºå°¾è°ƒç”¨
</span><span class=c1></span><span class=kd>function</span> <span class=nx>foo</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>if</span><span class=p>(</span><span class=nx>n</span><span class=o>&gt;</span><span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>meh</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
  <span class=p>}</span>
  <span class=k>return</span> <span class=nx>nco</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p>ä¸å±äºå°¾è°ƒç”¨çš„æƒ…å†µ</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=c1>// å‡½æ•°è°ƒç”¨åè¿˜æœ‰èµ‹å€¼æ“ä½œï¼Œæ‰€ä»¥ä¸å±äºå°¾è°ƒç”¨ï¼Œå³ä½¿è¯­ä¹‰ä¸€æ ·
</span><span class=c1></span><span class=kd>function</span> <span class=nx>foo</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>let</span> <span class=nx>tmp</span> <span class=o>=</span> <span class=nx>meh</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
  <span class=k>return</span> <span class=nx>tmp</span>
<span class=p>}</span>

<span class=c1>// å‡½æ•°è°ƒç”¨åè¿˜æœ‰ç›¸åŠ æ“ä½œ
</span><span class=c1></span><span class=kd>function</span> <span class=nx>foo</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nx>meh</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
<span class=p>}</span>

<span class=c1>// æ²¡æœ‰è¿”å›å‡½æ•°è°ƒç”¨
</span><span class=c1></span><span class=kd>function</span> <span class=nx>foo</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span> <span class=p>{</span>
  <span class=nx>meh</span><span class=p>(</span><span class=nx>n</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><h1 id=å°¾è°ƒç”¨ä¼˜åŒ–>å°¾è°ƒç”¨ä¼˜åŒ–</h1><blockquote><p>ã€€ã€€å‡½æ•°è°ƒç”¨ä¼šåœ¨å†…å­˜å½¢æˆä¸€ä¸ª"è°ƒç”¨è®°å½•"ï¼Œåˆç§°"è°ƒç”¨å¸§" (call frame)ï¼Œä¿å­˜è°ƒç”¨ä½ç½®å’Œå†…éƒ¨å˜é‡ç­‰ä¿¡æ¯ã€‚å¦‚æœåœ¨å‡½æ•°Açš„å†…éƒ¨è°ƒç”¨å‡½æ•°Bï¼Œé‚£ä¹ˆåœ¨Açš„è°ƒç”¨å¸§ä¸Šæ–¹ï¼Œè¿˜ä¼šå½¢æˆä¸€ä¸ªBçš„è°ƒç”¨å¸§ã€‚ç­‰åˆ°Bè¿è¡Œç»“æŸï¼Œå°†ç»“æœè¿”å›åˆ°Aï¼ŒBçš„è°ƒç”¨å¸§æ‰ä¼šæ¶ˆå¤±ã€‚å¦‚æœå‡½æ•°Bå†…éƒ¨è¿˜è°ƒç”¨å‡½æ•°Cï¼Œé‚£å°±è¿˜æœ‰ä¸€ä¸ªCçš„è°ƒç”¨å¸§ï¼Œä»¥æ­¤ç±»æ¨ã€‚æ‰€æœ‰çš„è°ƒç”¨å¸§ï¼Œå°±å½¢æˆä¸€ä¸ª"è°ƒç”¨æ ˆ" (call stack)ã€‚<br>ã€€ã€€å°¾è°ƒç”¨ç”±äºæ˜¯å‡½æ•°çš„æœ€åä¸€æ­¥æ“ä½œï¼Œæ‰€ä»¥ä¸éœ€è¦ä¿ç•™å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå› ä¸ºè°ƒç”¨ä½ç½®ã€å†…éƒ¨å˜é‡ç­‰ä¿¡æ¯éƒ½ä¸ä¼šå†ç”¨åˆ°äº†ï¼Œåªè¦ç›´æ¥ç”¨å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§å°±å¯ä»¥äº†ã€‚</p></blockquote><p>ä¸¾ä¾‹:</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>getItem</span><span class=p>(</span><span class=nx>item</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>return</span> <span class=nx>item</span>
<span class=p>}</span>

<span class=kd>function</span> <span class=nx>foo</span><span class=p>()</span> <span class=p>{</span>
  <span class=kd>let</span> <span class=nx>a</span><span class=o>=</span><span class=mi>1</span>
  <span class=kd>let</span> <span class=nx>b</span><span class=o>=</span><span class=mi>2</span>
  <span class=k>return</span> <span class=nx>getItem</span><span class=p>(</span><span class=nx>a</span><span class=o>+</span><span class=nx>b</span><span class=p>)</span>
<span class=p>}</span>
<span class=nx>foo</span><span class=p>()</span>
</code></pre></div><p>ä¸Šè¿°ä»£ç ä¸­ï¼Œå¦‚æœå‡½æ•°<code>getItem</code>ä¸æ˜¯å°¾è°ƒç”¨ï¼Œå‡½æ•°<code>foo</code>å°±è¦ä¿å­˜å†…éƒ¨å˜é‡<code>m</code>å’Œ<code>n</code>çš„å€¼ï¼Œä»¥åŠå‡½æ•°<code>getItem</code>çš„è°ƒç”¨ä½ç½®ç­‰ä¿¡æ¯ã€‚<br>ä½†å¦‚æœè°ƒç”¨<code>getItem</code>åï¼Œå‡½æ•°<code>foo</code>å°±ç»“æŸäº†ï¼Œæ‰€ä»¥æ‰§è¡Œåˆ°æœ€åä¸€æ­¥ï¼Œå¯ä»¥åˆ é™¤<code>foo</code>çš„è°ƒç”¨å¸§ï¼Œåªä¿ç•™<code>getItem(3)</code>çš„è°ƒç”¨å¸§ã€‚</p><blockquote><p>&ldquo;å°¾è°ƒç”¨ä¼˜åŒ–&rdquo; (Tail call optimization)ï¼Œå³åªä¿ç•™å†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§ã€‚<br><strong>PS: åªæœ‰ä¸å†ç”¨åˆ°å¤–å±‚å‡½æ•°çš„å†…éƒ¨å˜é‡ï¼Œå†…å±‚å‡½æ•°çš„è°ƒç”¨å¸§æ‰ä¼šå–ä»£å¤–å±‚å‡½æ•°çš„è°ƒç”¨å¸§ï¼Œå¦åˆ™å°±æ— æ³•è¿›è¡Œ"å°¾è°ƒç”¨ä¼˜åŒ–"ã€‚</strong></p></blockquote><h1 id=å°¾é€’å½’>å°¾é€’å½’</h1><p>å‡½æ•°è°ƒç”¨è‡ªèº«ï¼Œç§°ä¸ºé€’å½’ï¼›å¦‚æœå°¾è°ƒç”¨è‡ªèº«ï¼Œå°±ç§°ä¸ºå°¾é€’å½’ã€‚</p><blockquote><p>å¯¹äºå°¾é€’å½’æ¥è¯´ï¼Œç”±äºåªå­˜åœ¨ä¸€ä¸ªè°ƒç”¨å¸§ï¼Œæ‰€ä»¥èƒ½æœ‰æ•ˆçš„é¿å…"æ ˆæº¢å‡º"é”™è¯¯çš„å‘ç”Ÿã€‚</p></blockquote><p>æ”¹å†™ä¹‹å‰çš„ä»£ç :</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>factorial</span><span class=p>(</span><span class=nx>n</span><span class=p>,</span><span class=nx>total</span><span class=p>)</span> <span class=p>{</span>
  <span class=s2>&#34;use strict&#34;</span>
  <span class=nx>total</span> <span class=o>=</span> <span class=nx>total</span> <span class=o>||</span> <span class=mi>1</span>
  <span class=k>if</span><span class=p>(</span><span class=nx>n</span> <span class=o>&lt;=</span> <span class=mi>1</span><span class=p>)</span> <span class=k>return</span> <span class=nx>total</span>
  <span class=k>return</span> <span class=nx>factorial</span><span class=p>(</span><span class=nx>n</span><span class=o>-</span><span class=mi>1</span><span class=p>,</span> <span class=nx>n</span><span class=o>*</span><span class=nx>total</span><span class=p>)</span>
<span class=p>}</span>
</code></pre></div><p><strong>ES6çš„å°¾è°ƒç”¨ä¼˜åŒ–åªåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹å¼€å¯ï¼Œæ­£å¸¸æ¨¡å¼æ˜¯æ— æ•ˆçš„</strong></p><p>åœ¨æ­£å¸¸æ¨¡å¼ä¸‹ï¼Œå‡½æ•°å†…éƒ¨æœ‰ä¸¤ä¸ªå˜é‡ï¼Œå¯ä»¥è·Ÿè¸ªå‡½æ•°çš„è°ƒç”¨æ ˆã€‚</p><ul><li>arguments: è¿”å›è°ƒç”¨æ—¶å‡½æ•°çš„å‚æ•°ã€‚</li><li>caller: è¿”å›è°ƒç”¨å½“å‰å‡½æ•°çš„é‚£ä¸ªå‡½æ•°ã€‚</li></ul><p>å°¾è°ƒç”¨ä¼˜åŒ–å‘ç”Ÿæ—¶ï¼Œå‡½æ•°çš„è°ƒç”¨æ ˆä¼šæ”¹å†™ï¼Œå› æ­¤ä¸Šé¢ä¸¤ä¸ªå˜é‡å°±ä¼šå¤±çœŸã€‚ä¸¥æ ¼æ¨¡å¼ç¦ç”¨è¿™ä¸¤ä¸ªå˜é‡ï¼Œæ‰€ä»¥å°¾è°ƒç”¨æ¨¡å¼ä»…åœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ç”Ÿæ•ˆã€‚</p><p>å‚è€ƒ:</p><blockquote><p><a href=https://github.com/tc39/proposal-ptc-syntax/blob/master/README.md>https://github.com/tc39/proposal-ptc-syntax/blob/master/README.md</a></p></blockquote><p><strong>è¡¥å……(2019.06.02): å‡ºäºæŸäº›å› ç´ çš„è€ƒè™‘ï¼Œç›®å‰V8å¼•æ“ä¸­çš„å°¾é€’å½’ä¼˜åŒ–å·²ç»è¢«å»æ‰äº†</strong></p><p>å¤§æ¦‚åŸå› å¯ä»¥çœ‹è¿™ç¯‡åšå®¢:</p><blockquote><p><a href=https://imweb.io/topic/5a244260a192c3b460fce275>https://imweb.io/topic/5a244260a192c3b460fce275</a></p></blockquote><h1 id=å°¾é€’å½’ä¼˜åŒ–çš„å®ç°>å°¾é€’å½’ä¼˜åŒ–çš„å®ç°</h1><p>æ­£å¸¸æ¨¡å¼ä¸‹å¦‚ä½•å®ç°å°¾é€’å½’ä¼˜åŒ–å‘¢?</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>sum</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>y</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>sum</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>x</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>}</span>
<span class=nx>sum</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>100000</span><span class=p>)</span>
</code></pre></div><p>å°¾é€’å½’ä¹‹æ‰€ä»¥éœ€è¦ä¼˜åŒ–ï¼ŒåŸå› æ˜¯è°ƒç”¨æ ˆå¤ªå¤šï¼Œé€ æˆæº¢å‡ºï¼Œé‚£ä¹ˆåªè¦å‡å°‘è°ƒç”¨æ ˆï¼Œå°±ä¸ä¼šæº¢å‡ºã€‚</p><div class=highlight><pre class=chroma><code class=language-javascript data-lang=javascript><span class=kd>function</span> <span class=nx>tco</span><span class=p>(</span><span class=nx>f</span><span class=p>)</span> <span class=p>{</span>
  <span class=kd>var</span> <span class=nx>value</span><span class=p>;</span>
  <span class=kd>var</span> <span class=nx>active</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
  <span class=kd>var</span> <span class=nx>accumulated</span> <span class=o>=</span> <span class=p>[];</span>

  <span class=k>return</span> <span class=kd>function</span> <span class=nx>accumulator</span><span class=p>()</span> <span class=p>{</span>
    <span class=nx>accumulated</span><span class=p>.</span><span class=nx>push</span><span class=p>(</span><span class=nx>arguments</span><span class=p>);</span>
    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nx>active</span><span class=p>)</span> <span class=p>{</span>
      <span class=nx>active</span> <span class=o>=</span> <span class=kc>true</span><span class=p>;</span>
      <span class=k>while</span> <span class=p>(</span><span class=nx>accumulated</span><span class=p>.</span><span class=nx>length</span><span class=p>)</span> <span class=p>{</span>
        <span class=nx>value</span> <span class=o>=</span> <span class=nx>f</span><span class=p>.</span><span class=nx>apply</span><span class=p>(</span><span class=k>this</span><span class=p>,</span> <span class=nx>accumulated</span><span class=p>.</span><span class=nx>shift</span><span class=p>());</span>
      <span class=p>}</span>
      <span class=nx>active</span> <span class=o>=</span> <span class=kc>false</span><span class=p>;</span>
      <span class=k>return</span> <span class=nx>value</span><span class=p>;</span>
    <span class=p>}</span>
  <span class=p>};</span>
<span class=p>}</span>

<span class=kd>var</span> <span class=nx>sum</span> <span class=o>=</span> <span class=nx>tco</span><span class=p>(</span><span class=kd>function</span> <span class=nx>sum</span><span class=p>(</span><span class=nx>x</span><span class=p>,</span><span class=nx>y</span><span class=p>)</span> <span class=p>{</span>
  <span class=k>if</span> <span class=p>(</span><span class=nx>y</span> <span class=o>&gt;</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>sum</span><span class=p>(</span><span class=nx>x</span> <span class=o>+</span> <span class=mi>1</span><span class=p>,</span> <span class=nx>y</span> <span class=o>-</span> <span class=mi>1</span><span class=p>);</span>
  <span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
    <span class=k>return</span> <span class=nx>x</span><span class=p>;</span>
  <span class=p>}</span>
<span class=p>})</span>

<span class=nx>sum</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>100000</span><span class=p>)</span>
</code></pre></div></section><footer class=article-footer><section class=article-tags><a href=/tags/javascript/>JavaScript</a></section><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section></footer></article><aside class=related-contents--wrapper><h2 class=section-title>ç›¸å…³æ–‡ç« </h2><div class=related-contents><div class="flex article-list--tile"><article><a href=/p/webpack%E4%B8%ADcss%E6%A0%B7%E5%BC%8F%E7%9A%84%E5%A4%84%E7%90%86/><div class=article-details><h2 class=article-title>Webpackä¸­CSSæ ·å¼çš„å¤„ç†</h2></div></a></article><article><a href=/p/webpack%E9%85%8D%E7%BD%AEhtml-template/><div class=article-details><h2 class=article-title>Webpacké…ç½®HTML Template</h2></div></a></article><article><a href=/p/webpack%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE/><div class=article-details><h2 class=article-title>Webpackçš„å®‰è£…ä¸é…ç½®</h2></div></a></article><article><a href=/p/vue-router%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/><div class=article-details><h2 class=article-title>Vue Routerçš„å®‰è£…ä¸ä½¿ç”¨</h2></div></a></article><article><a href=/p/%E4%BD%BF%E7%94%A8vue-cli%E6%90%AD%E5%BB%BAvue%E9%A1%B9%E7%9B%AE/><div class=article-details><h2 class=article-title>ä½¿ç”¨Vue-cliæ­å»ºVueé¡¹ç›®</h2></div></a></article></div></div></aside><footer class=site-footer><section class=copyright>&copy;
2020 -
2024 Ilirus</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>Theme <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.2.0>Stack</a></b> designed by <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a></section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.css integrity="sha256-c0uckgykQ9v5k+IqViZOZKc47Jn7KQil4/MP3ySA3F8=" crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.css integrity="sha256-SBLU4vv6CA6lHsZ1XyTdhyjJxCjPif/TRkjnsyGAGnE=" crossorigin=anonymous></main></div><script src=https://cdn.jsdelivr.net/npm/node-vibrant@3.1.5/dist/vibrant.min.js integrity="sha256-5NovOZc4iwiAWTYIFiIM7DxKUXKWvpVEuMEPLzcm5/g=" crossorigin=anonymous defer></script><script type=text/javascript src=/ts/main.js defer></script><script>(function(){const a=document.createElement('link');a.href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap",a.type="text/css",a.rel="stylesheet",document.head.appendChild(a)})()</script></body></html>